<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>读取Excel表格的内容</title>
    <script src="WEB-INFO/js/jquery-3.5.1.js"></script>
    <script type="text/javascript" src="WEB-INFO/js/xlsx.js"></script>
</head>

<body>

    <input type="file" id="excel-file" onchange="Saveexcel(this)" name="excel-file" />

    <div class="content"></div>

    <script type="text/javascript">
        //JQuery代码
        //读取excel表中数据
        //
        var wb; //读取完成的数据
        var rABS = false; //是否将文件读取为二进制字符串
        function Saveexcel(obj) {
            if (!obj.files) {
                return;
            }
            //取得文件后缀名进行判断
            var location = $("input[name='excel-file']").val();
            var point = location.lastIndexOf(".");
            var type = location.substr(point);
            if (type != ".xlsx") {
                $.messager.alert('提示', '文档格式不正确,请上传后缀名是.xlsx的文件!', 'info');
                $('#excel-file').val("");
                return;
            }
            //文件后缀名条件符合
            else {
                var f = obj.files[0];
                var reader = new FileReader();
                reader.onload = function (e) {
                    var data = e.target.result;
                    var files = e.target;
                    if (rABS) {
                        wb = XLSX.read(btoa(fixdata(data)), {
                                type: 'base64'
                            }),
                            persons = [];
                    } else {
                        wb = XLSX.read(data, {
                                type: 'binary'
                            }),
                            persons = []; //存储取得的数据
                    }
                    //wb.SheetNames[0]是获取Sheets中第一个Sheet的名字
                    //wb.Sheets[Sheet名]获取第一个Sheet的数据
                    var JsonHtml = JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]));
                    var fromTo = ''; // 遍历每张表读取
                    for (var sheet in wb.Sheets) {
                        if (wb.Sheets.hasOwnProperty(sheet)) {
                            fromTo = wb.Sheets[sheet]['!ref'];
                            persons = persons.concat(XLSX.utils.sheet_to_json(wb.Sheets[sheet]));
                        }
                    };
                    //var dataID = ['deviceName', 'Type', 'FlowNumber', 'SerialNumber', 'Model', 'Computerroom', 'Company', 'Department', 'Supplier', 'PurchaseTime', 'PurchaseMoney', 'GuaranteeTime', 'CPU', 'Graphicscard', 'Memorybar', 'Amainboard', 'Soundcard', 'Remarks'];//input ID

                    if (rABS) {
                        reader.readAsArrayBuffer(f);
                    } else {
                        reader.readAsBinaryString(f);
                    }

                }
                
            };
        }
        
    </script>
</body>

</html>